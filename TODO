

====== general

(!) restore irods resumption in case of no files.

(!) submodule cellgeni/utils

!  Featurecounts more memory for bulk data; try dynamic nextflow directive

- -m hisat2 for multiQC?

-  samtools collate has -f option for fast. Can we use this?

-  star overhang 74: best to encode it somewhere?

-  software versions; move conda file to github.

-  NOTE mixcr fastqc
   mixcr was installed by me, not in conda environment.
   Should install it as cellgeni-su.
   fastqc was installed not as part of conda

?  enable fastqdir simultaneous with IRODS. this will help testing.
   so --fastqdirPE (stick flag in option), --samplefile_dir

-  check places where I built indexes for STAR and hisat2; save scripts/settings
      Done:
      rsync -avm --del --include='*RESUME*' -f 'hide,! */' DATA-indexes/ ~/DATA-indexes
      rsync -avm --del --include='*.config' -f 'hide,! */' DATA-indexes/ ~/DATA-indexes

#  star collectFile

#  check [text: "a b c\n"] idiom, mixed with collectFile on it.text, used downstream
   of ch_star_reject and ch_hisat2_reject.
!  However, it is perhaps neater to do this in the script, and generate a file
   (i.e. pick the approach taken in irods rather than star/hisat2).

#  ignore all columns from featurecounts except 1,7; file size is 30M per sample.

#  check_logs equivalent for hisat2, filter on overall alignment rate

  HISAT2 summary stats:
    Total pairs: 10000
      Aligned concordantly or discordantly 0 time: 1784 (17.84%)
      Aligned concordantly 1 time: 7343 (73.43%)
      Aligned concordantly >1 times: 873 (8.73%)
      Aligned discordantly 1 time: 0 (0.00%)
    Total unpaired reads: 3568
      Aligned 0 time: 3568 (100.00%)
      Aligned 1 time: 0 (0.00%)
      Aligned >1 times: 0 (0.00%)
    Overall alignment rate: 82.16%

#  collectFile pattern for lostcause (and any other merge process)

#  lostcause: add file size check in crams_to_fastq:
   or catch the STAR error if it happens. Test on small files, found in tic-148 / ijn
   Perhaps move indexbam functionality before HISAT2 and STAR,
   have a filter there. Anyway, make sure it is in lostcause.

#  use channel instead of publishbam process, subscribe

#  can I do fc for both hisat2 and STAR? with transpose yes.

#  merge_featurecounts.py: enable reading input files from -I metafile option

#  enable simultaneous hisat2 run with star (similar salmon)

====== lostcause

-  hopefully use future NF functionality in
      https://github.com/nextflow-io/nextflow/issues/903


